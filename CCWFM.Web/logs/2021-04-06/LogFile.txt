2021-04-06 06:59:18.7253|INFO|Info|User Iserial:5
2021-04-06 06:59:18.7353|ERROR|Info|{"Message":"Object reference not set to an instance of an object.","Data":{},"InnerException":null,"StackTrace":"   at CCWFM.ViewModel.Gl.CashDepositViewModel.<.ctor>b__5_25(Object o)\r\n   at GalaSoft.MvvmLight.Helpers.WeakFunc`2.Execute(T parameter)\r\n   at GalaSoft.MvvmLight.Command.RelayCommand`1.CanExecute(Object parameter)\r\n   at System.Windows.Controls.Primitives.ButtonBase.UpdateCanExecute()\r\n   at System.Windows.Controls.Primitives.ButtonBase.OnCommandChanged(DependencyPropertyChangedEventArgs e)\r\n   at System.Windows.Controls.Primitives.ButtonBase.OnCommandPropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)\r\n   at System.Windows.DependencyObject.RaisePropertyChangeNotifications(DependencyProperty dp, Object oldValue, Object newValue)\r\n   at System.Windows.DependencyObject.UpdateEffectiveValue(DependencyProperty property, EffectiveValueEntry oldEntry, EffectiveValueEntry& newEntry, ValueOperation operation)\r\n   at System.Windows.DependencyObject.RefreshExpression(DependencyProperty dp)\r\n   at System.Windows.Data.BindingExpression.SendDataToTarget()\r\n   at System.Windows.Data.BindingExpression.SourceAcquired()\r\n   at System.Windows.Data.BindingExpression.System.Windows.IDataContextChangedListener.OnDataContextChanged(Object sender, DataContextChangedEventArgs e)\r\n   at System.Windows.Data.BindingExpression.DataContextChanged(Object sender, DataContextChangedEventArgs e)\r\n   at System.Windows.DataContextChangedEventHandler.Invoke(Object sender, DataContextChangedEventArgs e)\r\n   at System.Windows.FrameworkElement.OnDataContextChanged(DataContextChangedEventArgs e)\r\n   at System.Windows.FrameworkElement.OnAncestorDataContextChanged(DataContextChangedEventArgs e)\r\n   at System.Windows.FrameworkElement.NotifyDataContextChanged(DataContextChangedEventArgs e)\r\n   at System.Windows.FrameworkElement.OnAncestorDataContextChanged(DataContextChangedEventArgs e)\r\n   at System.Windows.FrameworkElement.NotifyDataContextChanged(DataContextChangedEventArgs e)\r\n   at System.Windows.FrameworkElement.OnAncestorDataContextChanged(DataContextChangedEventArgs e)\r\n   at System.Windows.FrameworkElement.NotifyDataContextChanged(DataContextChangedEventArgs e)\r\n   at System.Windows.FrameworkElement.OnAncestorDataContextChanged(DataContextChangedEventArgs e)\r\n   at System.Windows.FrameworkElement.NotifyDataContextChanged(DataContextChangedEventArgs e)\r\n   at System.Windows.FrameworkElement.OnAncestorDataContextChanged(DataContextChangedEventArgs e)\r\n   at System.Windows.FrameworkElement.NotifyDataContextChanged(DataContextChangedEventArgs e)\r\n   at System.Windows.FrameworkElement.OnAncestorDataContextChanged(DataContextChangedEventArgs e)\r\n   at System.Windows.FrameworkElement.NotifyDataContextChanged(DataContextChangedEventArgs e)\r\n   at System.Windows.FrameworkElement.OnTreeParentUpdated(DependencyObject newParent, Boolean bIsNewParentAlive)\r\n   at System.Windows.DependencyObject.UpdateTreeParent(IManagedPeer oldParent, IManagedPeer newParent, Boolean bIsNewParentAlive, Boolean keepReferenceToParent)\r\n   at MS.Internal.FrameworkCallbacks.ManagedPeerTreeUpdate(IntPtr oldParentElement, IntPtr parentElement, IntPtr childElement, Byte bIsParentAlive, Byte bKeepReferenceToParent, Boolean canCreateParent)"}
2021-04-06 07:49:47.3834|INFO|Info|User Iserial:1518
2021-04-06 07:49:47.3944|ERROR|Info|{"Message":"An exception occurred during the operation, making the result invalid.  Check InnerException for exception details.","Data":{},"InnerException":{"Detail":{"InnerException":{"InnerException":{"InnerException":null,"Message":"The transaction manager has disabled its support for remote/network transactions. (Exception from HRESULT: 0x8004D024)","StackTrace":"   at System.Transactions.Oletx.IDtcProxyShimFactory.ReceiveTransaction(UInt32 propgationTokenSize, Byte[] propgationToken, IntPtr managedIdentifier, Guid& transactionIdentifier, OletxTransactionIsolationLevel& isolationLevel, ITransactionShim& transactionShim)\r\n   at System.Transactions.TransactionInterop.GetOletxTransactionFromTransmitterPropigationToken(Byte[] propagationToken)","Type":"System.Runtime.InteropServices.COMException"},"Message":"Network access for Distributed Transaction Manager (MSDTC) has been disabled. Please enable DTC for network access in the security configuration for MSDTC using the Component Services Administrative tool.","StackTrace":"   at System.Transactions.Oletx.OletxTransactionManager.ProxyException(COMException comException)\r\n   at System.Transactions.TransactionInterop.GetOletxTransactionFromTransmitterPropigationToken(Byte[] propagationToken)\r\n   at System.Transactions.TransactionStatePSPEOperation.PSPEPromote(InternalTransaction tx)\r\n   at System.Transactions.TransactionStateDelegatedBase.EnterState(InternalTransaction tx)\r\n   at System.Transactions.EnlistableStates.Promote(InternalTransaction tx)\r\n   at System.Transactions.Transaction.Promote()\r\n   at System.Transactions.TransactionInterop.ConvertToOletxTransaction(Transaction transaction)\r\n   at System.Transactions.TransactionInterop.GetExportCookie(Transaction transaction, Byte[] whereabouts)\r\n   at System.Data.SqlClient.SqlInternalConnection.GetTransactionCookie(Transaction transaction, Byte[] whereAbouts)\r\n   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)\r\n   at System.Data.SqlClient.SqlInternalConnection.Enlist(Transaction tx)\r\n   at System.Data.SqlClient.SqlInternalConnectionTds.Activate(Transaction transaction)\r\n   at System.Data.ProviderBase.DbConnectionInternal.ActivateConnection(Transaction transaction)\r\n   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)\r\n   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at System.Data.SqlClient.SqlConnection.TryOpenInner(TaskCompletionSource`1 retry)\r\n   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)\r\n   at System.Data.SqlClient.SqlConnection.Open()\r\n   at System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean& closeStoreConnectionOnFailure)","Type":"System.Transactions.TransactionManagerCommunicationException"},"Message":"The underlying provider failed on Open.","StackTrace":"   at CCWFM.Web.Service.BankDepositOp.BankDepositService.UpdateOrInsertCashDepositHeader(TblCashDepositHeader newRow, String company, Int32 index, Int32 userIserial, Int32& outindex) in D:\\CCWFM\\CCWFM.Web\\Service\\BankDepositOp\\BankDeposit.cs:line 168\r\n   at SyncInvokeUpdateOrInsertCashDepositHeader(Object , Object[] , Object[] )\r\n   at System.ServiceModel.Dispatcher.SyncMethodInvoker.Invoke(Object instance, Object[] inputs, Object[]& outputs)\r\n   at System.ServiceModel.Dispatcher.DispatchOperationRuntime.InvokeBegin(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage5(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage41(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage4(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage31(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage3(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage2(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage11(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage1(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.MessageRpc.Process(Boolean isOperationContextSet)","Type":"System.Data.EntityException"},"Action":"http://schemas.microsoft.com/net/2005/12/windowscommunicationfoundation/dispatcher/fault","Code":{"IsPredefinedFault":true,"IsSenderFault":false,"IsReceiverFault":true,"Namespace":"http://www.w3.org/2003/05/soap-envelope","Name":"Receiver","SubCode":{"IsPredefinedFault":false,"IsSenderFault":false,"IsReceiverFault":false,"Namespace":"http://schemas.microsoft.com/net/2005/12/windowscommunicationfoundation/dispatcher","Name":"InternalServiceFault","SubCode":null}},"Message":"The underlying provider failed on Open.","Reason":{"Translations":[{"XmlLang":"en-US","Text":"The underlying provider failed on Open."}]},"Data":{},"InnerException":null,"StackTrace":"   at System.ServiceModel.Channels.ServiceChannel.ThrowIfFaultUnderstood(Message reply, MessageFault fault, String action, MessageVersion version, FaultConverter faultConverter)\r\n   at System.ServiceModel.Channels.ServiceChannel.HandleReply(ProxyOperationRuntime operation, ProxyRpc& rpc)\r\n   at System.ServiceModel.Channels.ServiceChannel.EndCall(String action, Object[] outs, IAsyncResult result)\r\n   at System.ServiceModel.ClientBase`1.ChannelBase`1.EndInvoke(String methodName, Object[] args, IAsyncResult result)\r\n   at CCWFM.BankDepositService.BankDepositServiceClient.BankDepositServiceClientChannel.EndUpdateOrInsertCashDepositHeader(Int32& outindex, IAsyncResult result)\r\n   at CCWFM.BankDepositService.BankDepositServiceClient.CCWFM.BankDepositService.BankDepositService.EndUpdateOrInsertCashDepositHeader(Int32& outindex, IAsyncResult result)\r\n   at CCWFM.BankDepositService.BankDepositServiceClient.OnEndUpdateOrInsertCashDepositHeader(IAsyncResult result)\r\n   at System.ServiceModel.ClientBase`1.OnAsyncCallCompleted(IAsyncResult result)"},"StackTrace":"   at System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary()\r\n   at CCWFM.BankDepositService.UpdateOrInsertCashDepositHeaderCompletedEventArgs.get_Result()\r\n   at CCWFM.ViewModel.Gl.CashDepositViewModel.<.ctor>b__6_33(Object s, UpdateOrInsertCashDepositHeaderCompletedEventArgs x)\r\n   at CCWFM.BankDepositService.BankDepositServiceClient.OnUpdateOrInsertCashDepositHeaderCompleted(Object state)"}
2021-04-06 09:28:30.2369|INFO|Info|User Iserial:1518
2021-04-06 09:28:30.2479|ERROR|Info|{"Message":"An exception occurred during the operation, making the result invalid.  Check InnerException for exception details.","Data":{},"InnerException":{"Detail":{"InnerException":{"InnerException":null,"Message":"The operation is not valid for the state of the transaction.","StackTrace":"   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)\r\n   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)\r\n   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)\r\n   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)\r\n   at System.Data.SqlClient.SqlInternalConnection.Enlist(Transaction tx)\r\n   at System.Data.SqlClient.SqlInternalConnectionTds.Activate(Transaction transaction)\r\n   at System.Data.ProviderBase.DbConnectionInternal.ActivateConnection(Transaction transaction)\r\n   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)\r\n   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at System.Data.SqlClient.SqlConnection.TryOpenInner(TaskCompletionSource`1 retry)\r\n   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)\r\n   at System.Data.SqlClient.SqlConnection.Open()\r\n   at System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean& closeStoreConnectionOnFailure)","Type":"System.Transactions.TransactionException"},"Message":"The underlying provider failed on Open.","StackTrace":"   at CCWFM.Web.Service.BankDepositOp.BankDepositService.UpdateOrInsertCashDepositHeader(TblCashDepositHeader newRow, String company, Int32 index, Int32 userIserial, Int32& outindex) in D:\\CCWFM\\CCWFM.Web\\Service\\BankDepositOp\\BankDeposit.cs:line 168\r\n   at SyncInvokeUpdateOrInsertCashDepositHeader(Object , Object[] , Object[] )\r\n   at System.ServiceModel.Dispatcher.SyncMethodInvoker.Invoke(Object instance, Object[] inputs, Object[]& outputs)\r\n   at System.ServiceModel.Dispatcher.DispatchOperationRuntime.InvokeBegin(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage5(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage41(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage4(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage31(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage3(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage2(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage11(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage1(MessageRpc& rpc)\r\n   at System.ServiceModel.Dispatcher.MessageRpc.Process(Boolean isOperationContextSet)","Type":"System.Data.EntityException"},"Action":"http://schemas.microsoft.com/net/2005/12/windowscommunicationfoundation/dispatcher/fault","Code":{"IsPredefinedFault":true,"IsSenderFault":false,"IsReceiverFault":true,"Namespace":"http://www.w3.org/2003/05/soap-envelope","Name":"Receiver","SubCode":{"IsPredefinedFault":false,"IsSenderFault":false,"IsReceiverFault":false,"Namespace":"http://schemas.microsoft.com/net/2005/12/windowscommunicationfoundation/dispatcher","Name":"InternalServiceFault","SubCode":null}},"Message":"The underlying provider failed on Open.","Reason":{"Translations":[{"XmlLang":"en-US","Text":"The underlying provider failed on Open."}]},"Data":{},"InnerException":null,"StackTrace":"   at System.ServiceModel.Channels.ServiceChannel.ThrowIfFaultUnderstood(Message reply, MessageFault fault, String action, MessageVersion version, FaultConverter faultConverter)\r\n   at System.ServiceModel.Channels.ServiceChannel.HandleReply(ProxyOperationRuntime operation, ProxyRpc& rpc)\r\n   at System.ServiceModel.Channels.ServiceChannel.EndCall(String action, Object[] outs, IAsyncResult result)\r\n   at System.ServiceModel.ClientBase`1.ChannelBase`1.EndInvoke(String methodName, Object[] args, IAsyncResult result)\r\n   at CCWFM.BankDepositService.BankDepositServiceClient.BankDepositServiceClientChannel.EndUpdateOrInsertCashDepositHeader(Int32& outindex, IAsyncResult result)\r\n   at CCWFM.BankDepositService.BankDepositServiceClient.CCWFM.BankDepositService.BankDepositService.EndUpdateOrInsertCashDepositHeader(Int32& outindex, IAsyncResult result)\r\n   at CCWFM.BankDepositService.BankDepositServiceClient.OnEndUpdateOrInsertCashDepositHeader(IAsyncResult result)\r\n   at System.ServiceModel.ClientBase`1.OnAsyncCallCompleted(IAsyncResult result)"},"StackTrace":"   at System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary()\r\n   at CCWFM.BankDepositService.UpdateOrInsertCashDepositHeaderCompletedEventArgs.get_Result()\r\n   at CCWFM.ViewModel.Gl.CashDepositViewModel.<.ctor>b__6_33(Object s, UpdateOrInsertCashDepositHeaderCompletedEventArgs x)\r\n   at CCWFM.BankDepositService.BankDepositServiceClient.OnUpdateOrInsertCashDepositHeaderCompleted(Object state)"}
2021-04-06 10:19:22.5008|INFO|Info|Start SendApproveMail- headerIserial = 79953, storeIserial = 10, company = CCNEW, userIserial = 1518
2021-04-06 10:19:23.8500|INFO|Info|User Iserial:1518
2021-04-06 10:19:23.8500|ERROR|Info|{"ClassName":"System.Web.Services.Protocols.SoapException","Message":"This report requires a default or user-defined value for the report parameter 'DataBase'. To run or subscribe to this report, you must provide a parameter value. ---> Microsoft.ReportingServices.Diagnostics.Utilities.ReportParameterValueNotSetException: This report requires a default or user-defined value for the report parameter 'DataBase'. To run or subscribe to this report, you must provide a parameter value.","Data":{"code":{"Namespace":"http://schemas.xmlsoap.org/soap/envelope/","Name":"Client","IsEmpty":false},"actor":"http://websrv/ReportServer/ReportExecution2005.asmx","role":"","subCode":null,"lang":""},"InnerException":null,"HelpURL":null,"StackTraceString":"   at System.Web.Services.Protocols.SoapHttpClientProtocol.ReadResponse(SoapClientMessage message, WebResponse response, Stream responseStream, Boolean asyncCall)\r\n   at System.Web.Services.Protocols.SoapHttpClientProtocol.Invoke(String methodName, Object[] parameters)\r\n   at Microsoft.Reporting.WebForms.Internal.Soap.ReportingServices2005.Execution.ReportExecutionService.Render(String Format, String DeviceInfo, String& Extension, String& MimeType, String& Encoding, Warning[]& Warnings, String[]& StreamIds)\r\n   at CCWFM.Web.Service.Operations.SharedOperation.SendMailReport(String reportName, String reportTitle, List`1 parameters, String company, String emailTo, String Subject, String body) in D:\\CCWFM\\CCWFM.Web\\Service\\Operations\\SharedOperation.cs:line 420\r\n   at CCWFM.Web.Service.BankDepositOp.BankDepositService.SendApproveMail(Int32 headerIserial, Int32 storeIserial, DateTime date, String company, String Sequance, Int32 userIserial) in D:\\CCWFM\\CCWFM.Web\\Service\\BankDepositOp\\BankDeposit.cs:line 300","RemoteStackTraceString":null,"RemoteStackIndex":0,"ExceptionMethod":"8\nReadResponse\nSystem.Web.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\nSystem.Web.Services.Protocols.SoapHttpClientProtocol\nSystem.Object[] ReadResponse(System.Web.Services.Protocols.SoapClientMessage, System.Net.WebResponse, System.IO.Stream, Boolean)","HResult":-2146233087,"Source":"System.Web.Services","WatsonBuckets":null}
